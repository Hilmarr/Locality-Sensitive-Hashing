nvprof --unified-memory-profiling off ./lsh_parallel_5 \
> ../test_data/sift/sift_base.fvecs \
> ../test_data/sift/sift_query.fvecs \
> ../test_data/sift/sift_groundtruth.ivecs \
> ../creating_hyperplanes/random_1000_zerosum_unit_hyperplanes.dat
==1419664== NVPROF is profiling process 1419664, command: ./lsh_parallel_5 ../test_data/sift/sift_base.fvecs ../test_data/sift/sift_query.fvecs ../test_data/sift/sift_groundtruth.ivecs ../creating_hyperplanes/random_1000_zerosum_unit_hyperplanes.dat
calculate_hash_values for base vectors:
   - time: 0.584 seconds
organize_points_into_groups:
   - time: 0.007 seconds
calculate_hash_values_and_dists for query vectors:
   - time: 0.002 seconds
find_potential_matches for query vectors:
   - time: 0.832 seconds
match points:
   - time: 1.382 seconds
Correct ratio: 0.873700

Potential matches found: 629197070
Comparisons per query vector: 62919.707000
Average portion of search space searched: 0.062920

==1419664== Profiling application: ./lsh_parallel_5 ../test_data/sift/sift_base.fvecs ../test_data/sift/sift_query.fvecs ../test_data/sift/sift_groundtruth.ivecs ../creating_hyperplanes/random_1000_zerosum_unit_hyperplanes.dat
==1419664== Profiling result:
            Type  Time(%)      Time     Calls       Avg       Min       Max  Name
 GPU activities:   73.83%  866.53ms         1  866.53ms  866.53ms  866.53ms  match_points_395_gpu(int, int, float*, float*, int, int*, int*, int*, float*, int*, float*)
                   24.70%  289.89ms       220  1.3177ms  2.6240us  1.3836ms  [CUDA memcpy HtoD]
                    1.44%  16.900ms         1  16.900ms  16.900ms  16.900ms  calculate_hash_values_51_gpu(int, float*, int, float*, int*)
                    0.03%  320.27us         5  64.054us  3.7440us  304.69us  [CUDA memcpy DtoH]
      API calls:   77.06%  885.20ms         6  147.53ms  1.0090us  866.53ms  cuStreamSynchronize
                   19.48%  223.81ms         1  223.81ms  223.81ms  223.81ms  cuDevicePrimaryCtxRetain
                    2.60%  29.818ms         1  29.818ms  29.818ms  29.818ms  cuMemHostAlloc
                    0.41%  4.6906ms        11  426.42us  2.4720us  2.3944ms  cuMemAlloc
                    0.22%  2.5494ms       220  11.588us  3.3460us  38.024us  cuMemcpyHtoDAsync
                    0.09%  1.0438ms         1  1.0438ms  1.0438ms  1.0438ms  cuMemAllocHost
                    0.06%  704.50us       217  3.2460us     498ns  20.529us  cuEventSynchronize
                    0.05%  623.10us       218  2.8580us  1.7270us  8.6510us  cuEventRecord
                    0.01%  95.864us         1  95.864us  95.864us  95.864us  cuModuleLoadDataEx
                    0.01%  73.428us        10  7.3420us     385ns  51.603us  cuPointerGetAttributes
                    0.01%  62.287us         2  31.143us  25.788us  36.499us  cuLaunchKernel
                    0.00%  37.512us         5  7.5020us  3.3350us  18.931us  cuMemcpyDtoHAsync
                    0.00%  20.721us         1  20.721us  20.721us  20.721us  cuStreamCreate
                    0.00%  12.943us         6  2.1570us     560ns  4.6850us  cuEventCreate
                    0.00%  12.569us         4  3.1420us     998ns  9.1640us  cuDeviceGetPCIBusId
                    0.00%  3.5430us        20     177ns     132ns     621ns  cuDeviceGetAttribute
                    0.00%  2.3240us         2  1.1620us     480ns  1.8440us  cuModuleGetFunction
                    0.00%  2.0840us         3     694ns     327ns     923ns  cuCtxSetCurrent
                    0.00%  1.3790us         8     172ns     119ns     457ns  cuDeviceGet
                    0.00%     708ns         4     177ns     129ns     301ns  cuDeviceComputeCapability
                    0.00%     576ns         2     288ns     131ns     445ns  cuDeviceGetCount
                    0.00%     477ns         1     477ns     477ns     477ns  cuCtxGetCurrent
                    0.00%     151ns         1     151ns     151ns     151ns  cuDriverGetVersion
 OpenACC (excl):   57.07%  867.72ms         2  433.86ms  1.1781ms  866.54ms  acc_wait@lsh_parallel_5.cpp:395
                   33.55%  510.20ms         1  510.20ms  510.20ms  510.20ms  acc_enter_data@lsh_parallel_5.cpp:395
                    7.84%  119.16ms         1  119.16ms  119.16ms  119.16ms  acc_enter_data@lsh_parallel_5.cpp:51
                    1.13%  17.207ms         2  8.6034ms  307.28us  16.900ms  acc_wait@lsh_parallel_5.cpp:51
                    0.21%  3.2167ms       188  17.110us  4.3080us  49.305us  acc_enqueue_upload@lsh_parallel_5.cpp:395
                    0.13%  2.0457ms         1  2.0457ms  2.0457ms  2.0457ms  acc_wait@lsh_parallel_5.cpp:74
                    0.04%  569.33us        32  17.791us  5.7040us  48.780us  acc_enqueue_upload@lsh_parallel_5.cpp:51
                    0.01%  125.44us         1  125.44us  125.44us  125.44us  acc_device_init@lsh_parallel_5.cpp:51
                    0.00%  61.365us         4  15.341us  8.6550us  29.869us  acc_enqueue_download@lsh_parallel_5.cpp:434
                    0.00%  42.558us         1  42.558us  42.558us  42.558us  acc_enqueue_launch@lsh_parallel_5.cpp:395 (_Z20match_points_395_gpuiiPfS_iPiS0_S0_S_S0_S_)
                    0.00%  32.330us         1  32.330us  32.330us  32.330us  acc_wait@lsh_parallel_5.cpp:434
                    0.00%  31.033us         1  31.033us  31.033us  31.033us  acc_enqueue_launch@lsh_parallel_5.cpp:51 (_Z28calculate_hash_values_51_gpuiPfiS_Pi)
                    0.00%  29.592us         1  29.592us  29.592us  29.592us  acc_enqueue_download@lsh_parallel_5.cpp:74
                    0.00%  29.095us         1  29.095us  29.095us  29.095us  acc_exit_data@lsh_parallel_5.cpp:395
                    0.00%  25.167us         1  25.167us  25.167us  25.167us  acc_exit_data@lsh_parallel_5.cpp:51
                    0.00%  12.327us         1  12.327us  12.327us  12.327us  acc_compute_construct@lsh_parallel_5.cpp:51
                    0.00%  5.8050us         1  5.8050us  5.8050us  5.8050us  acc_compute_construct@lsh_parallel_5.cpp:395
                    0.00%       0ns         8       0ns       0ns       0ns  acc_delete@lsh_parallel_5.cpp:434
                    0.00%       0ns         8       0ns       0ns       0ns  acc_create@lsh_parallel_5.cpp:395
                    0.00%       0ns         3       0ns       0ns       0ns  acc_delete@lsh_parallel_5.cpp:74
                    0.00%       0ns         3       0ns       0ns       0ns  acc_alloc@lsh_parallel_5.cpp:51
                    0.00%       0ns         3       0ns       0ns       0ns  acc_create@lsh_parallel_5.cpp:51
                    0.00%       0ns         7       0ns       0ns       0ns  acc_alloc@lsh_parallel_5.cpp:395

==1419664== NVTX result:
==1419664==   Thread "<unnamed>" (id = 1434557696)
==1419664==     Domain "<unnamed>"
==1419664==       Range "Calculating hash values for base vectors"
            Type  Time(%)      Time     Calls       Avg       Min       Max  Name
          Range:  100.00%  466.78ms         1  466.78ms  466.78ms  466.78ms  Calculating hash values for base vectors
 GPU activities:   70.90%  41.918ms        32  1.3099ms  2.6240us  1.3835ms  [CUDA memcpy HtoD]
                   28.59%  16.900ms         1  16.900ms  16.900ms  16.900ms  calculate_hash_values_51_gpu(int, float*, int, float*, int*)
                    0.52%  304.69us         1  304.69us  304.69us  304.69us  [CUDA memcpy DtoH]
      API calls:   91.80%  371.85us        32  11.620us  4.6720us  27.370us  cuMemcpyHtoDAsync
                    6.37%  25.788us         1  25.788us  25.788us  25.788us  cuLaunchKernel
                    1.83%  7.4070us         1  7.4070us  7.4070us  7.4070us  cuMemcpyDtoHAsync

==1419664==       Range "Calculating hash values for query vectors"
            Type  Time(%)      Time     Calls       Avg       Min       Max  Name
          Range:  100.00%  2.6455ms         1  2.6455ms  2.6455ms  2.6455ms  Calculating hash values for query vectors
No kernels were profiled in this range.
No API activities were profiled in this range.

==1419664==       Range "Constructing lsh tables"
            Type  Time(%)      Time     Calls       Avg       Min       Max  Name
          Range:  100.00%  6.1541ms         1  6.1541ms  6.1541ms  6.1541ms  Constructing lsh tables
No kernels were profiled in this range.
No API activities were profiled in this range.

==1419664==       Range "Finding potential matches"
            Type  Time(%)      Time     Calls       Avg       Min       Max  Name
          Range:  100.00%  831.94ms         1  831.94ms  831.94ms  831.94ms  Finding potential matches
No kernels were profiled in this range.
No API activities were profiled in this range.

==1419664==       Range "Matching potential matches"
            Type  Time(%)      Time     Calls       Avg       Min       Max  Name
          Range:  100.00%  1.38132s         1  1.38132s  1.38132s  1.38132s  Matching potential matches
 GPU activities:   77.75%  866.53ms         1  866.53ms  866.53ms  866.53ms  match_points_395_gpu(int, int, float*, float*, int, int*, int*, int*, float*, int*, float*)
                   22.25%  247.97ms       188  1.3190ms  5.0240us  1.3836ms  [CUDA memcpy HtoD]
                    0.00%  15.585us         4  3.8960us  3.7440us  4.2880us  [CUDA memcpy DtoH]
      API calls:   97.03%  2.1775ms       188  11.582us  3.3460us  38.024us  cuMemcpyHtoDAsync
                    1.63%  36.499us         1  36.499us  36.499us  36.499us  cuLaunchKernel
                    1.34%  30.105us         4  7.5260us  3.3350us  18.931us  cuMemcpyDtoHAsync

