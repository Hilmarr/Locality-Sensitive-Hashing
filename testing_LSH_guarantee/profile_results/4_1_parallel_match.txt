nvprof --unified-memory-profiling off ./lsh_parallel_4 \
> ../test_data/sift/sift_base.fvecs \
> ../test_data/sift/sift_query.fvecs \
> ../test_data/sift/sift_groundtruth.ivecs \
> ../creating_hyperplanes/random_1000_zerosum_unit_hyperplanes.dat
==1415813== NVPROF is profiling process 1415813, command: ./lsh_parallel_4 ../test_data/sift/sift_base.fvecs ../test_data/sift/sift_query.fvecs ../test_data/sift/sift_groundtruth.ivecs ../creating_hyperplanes/random_1000_zerosum_unit_hyperplanes.dat
calculate_hash_values for base vectors:
   - time: 0.609 seconds
organize_points_into_groups:
   - time: 0.006 seconds
calculate_hash_values_and_dists for query vectors:
   - time: 0.002 seconds
find_potential_matches for query vectors:
   - time: 0.832 seconds
match points:
   - time: 2.444 seconds
Correct ratio: 0.873700

Potential matches found: 629197070
Comparisons per query vector: 62919.707000
Average portion of search space searched: 0.062920

==1415813== Profiling application: ./lsh_parallel_4 ../test_data/sift/sift_base.fvecs ../test_data/sift/sift_query.fvecs ../test_data/sift/sift_groundtruth.ivecs ../creating_hyperplanes/random_1000_zerosum_unit_hyperplanes.dat
==1415813== Profiling result:
            Type  Time(%)      Time     Calls       Avg       Min       Max  Name
 GPU activities:   85.03%  1.93133s         1  1.93133s  1.93133s  1.93133s  match_points_395_gpu(int, int, float*, float*, int, int*, int*, int*, float*, int*, float*)
                   12.74%  289.41ms       220  1.3155ms  2.3680us  1.3808ms  [CUDA memcpy HtoD]
                    2.21%  50.153ms         1  50.153ms  50.153ms  50.153ms  calculate_hash_values_51_gpu(int, float*, int, float*, int*)
                    0.01%  325.97us         5  65.193us  3.7760us  310.26us  [CUDA memcpy DtoH]
      API calls:   88.52%  1.98324s         6  330.54ms  2.5370us  1.93135s  cuStreamSynchronize
                    9.77%  218.90ms         1  218.90ms  218.90ms  218.90ms  cuDevicePrimaryCtxRetain
                    1.25%  27.983ms         1  27.983ms  27.983ms  27.983ms  cuMemHostAlloc
                    0.21%  4.6806ms        11  425.51us  3.1940us  2.3357ms  cuMemAlloc
                    0.12%  2.6465ms       220  12.029us  4.2030us  42.139us  cuMemcpyHtoDAsync
                    0.05%  1.0963ms         1  1.0963ms  1.0963ms  1.0963ms  cuMemAllocHost
                    0.04%  899.75us       217  4.1460us     499ns  18.469us  cuEventSynchronize
                    0.03%  662.76us       218  3.0400us  1.7930us  8.1640us  cuEventRecord
                    0.00%  89.788us         1  89.788us  89.788us  89.788us  cuModuleLoadDataEx
                    0.00%  78.243us        10  7.8240us     553ns  52.038us  cuPointerGetAttributes
                    0.00%  73.942us         5  14.788us  4.2480us  48.976us  cuMemcpyDtoHAsync
                    0.00%  67.816us         2  33.908us  28.699us  39.117us  cuLaunchKernel
                    0.00%  13.840us         4  3.4600us  1.3870us  7.7310us  cuDeviceGetPCIBusId
                    0.00%  13.611us         1  13.611us  13.611us  13.611us  cuStreamCreate
                    0.00%  12.831us         6  2.1380us     529ns  5.6020us  cuEventCreate
                    0.00%  3.3480us        20     167ns     126ns     476ns  cuDeviceGetAttribute
                    0.00%  2.4490us         3     816ns     304ns  1.3570us  cuCtxSetCurrent
                    0.00%  2.0930us         2  1.0460us     632ns  1.4610us  cuModuleGetFunction
                    0.00%  1.3410us         8     167ns     116ns     435ns  cuDeviceGet
                    0.00%     690ns         4     172ns     123ns     306ns  cuDeviceComputeCapability
                    0.00%     569ns         2     284ns     147ns     422ns  cuDeviceGetCount
                    0.00%     426ns         1     426ns     426ns     426ns  cuCtxGetCurrent
                    0.00%     372ns         1     372ns     372ns     372ns  cuDriverGetVersion
 OpenACC (excl):   73.94%  1.93252s         2  966.26ms  1.1405ms  1.93137s  acc_wait@lsh_parallel_4.cpp:395
                   19.43%  507.85ms         1  507.85ms  507.85ms  507.85ms  acc_enter_data@lsh_parallel_4.cpp:395
                    4.46%  116.56ms         1  116.56ms  116.56ms  116.56ms  acc_enter_data@lsh_parallel_4.cpp:51
                    1.93%  50.458ms         2  25.229ms  305.36us  50.153ms  acc_wait@lsh_parallel_4.cpp:51
                    0.12%  3.0704ms       188  16.331us  5.5730us  56.920us  acc_enqueue_upload@lsh_parallel_4.cpp:395
                    0.08%  2.0224ms         1  2.0224ms  2.0224ms  2.0224ms  acc_wait@lsh_parallel_4.cpp:74
                    0.02%  649.07us        32  20.283us  7.0680us  41.189us  acc_enqueue_upload@lsh_parallel_4.cpp:51
                    0.00%  121.22us         1  121.22us  121.22us  121.22us  acc_device_init@lsh_parallel_4.cpp:51
                    0.00%  99.627us         4  24.906us  8.4860us  66.954us  acc_enqueue_download@lsh_parallel_4.cpp:434
                    0.00%  76.587us         1  76.587us  76.587us  76.587us  acc_wait@lsh_parallel_4.cpp:434
                    0.00%  46.295us         1  46.295us  46.295us  46.295us  acc_enqueue_launch@lsh_parallel_4.cpp:395 (_Z20match_points_395_gpuiiPfS_iPiS0_S0_S_S0_S_)
                    0.00%  44.710us         1  44.710us  44.710us  44.710us  acc_exit_data@lsh_parallel_4.cpp:395
                    0.00%  34.723us         1  34.723us  34.723us  34.723us  acc_enqueue_launch@lsh_parallel_4.cpp:51 (_Z28calculate_hash_values_51_gpuiPfiS_Pi)
                    0.00%  33.428us         1  33.428us  33.428us  33.428us  acc_enqueue_download@lsh_parallel_4.cpp:74
                    0.00%  29.808us         1  29.808us  29.808us  29.808us  acc_exit_data@lsh_parallel_4.cpp:51
                    0.00%  12.838us         1  12.838us  12.838us  12.838us  acc_compute_construct@lsh_parallel_4.cpp:51
                    0.00%  10.084us         1  10.084us  10.084us  10.084us  acc_compute_construct@lsh_parallel_4.cpp:395
                    0.00%       0ns         3       0ns       0ns       0ns  acc_create@lsh_parallel_4.cpp:51
                    0.00%       0ns         8       0ns       0ns       0ns  acc_delete@lsh_parallel_4.cpp:434
                    0.00%       0ns         8       0ns       0ns       0ns  acc_create@lsh_parallel_4.cpp:395
                    0.00%       0ns         7       0ns       0ns       0ns  acc_alloc@lsh_parallel_4.cpp:395
                    0.00%       0ns         3       0ns       0ns       0ns  acc_delete@lsh_parallel_4.cpp:74
                    0.00%       0ns         3       0ns       0ns       0ns  acc_alloc@lsh_parallel_4.cpp:51

==1415813== NVTX result:
==1415813==   Thread "<unnamed>" (id = 1415535872)
==1415813==     Domain "<unnamed>"
==1415813==       Range "Calculating hash values for base vectors"
            Type  Time(%)      Time     Calls       Avg       Min       Max  Name
          Range:  100.00%  492.77ms         1  492.77ms  492.77ms  492.77ms  Calculating hash values for base vectors
 GPU activities:   54.29%  50.153ms         1  50.153ms  50.153ms  50.153ms  calculate_hash_values_51_gpu(int, float*, int, float*, int*)
                   45.37%  41.915ms        32  1.3098ms  2.3680us  1.3808ms  [CUDA memcpy HtoD]
                    0.34%  310.26us         1  310.26us  310.26us  310.26us  [CUDA memcpy DtoH]
      API calls:   91.85%  440.49us        32  13.765us  5.8780us  28.884us  cuMemcpyHtoDAsync
                    5.98%  28.699us         1  28.699us  28.699us  28.699us  cuLaunchKernel
                    2.17%  10.393us         1  10.393us  10.393us  10.393us  cuMemcpyDtoHAsync

==1415813==       Range "Calculating hash values for query vectors"
            Type  Time(%)      Time     Calls       Avg       Min       Max  Name
          Range:  100.00%  2.6768ms         1  2.6768ms  2.6768ms  2.6768ms  Calculating hash values for query vectors
No kernels were profiled in this range.
No API activities were profiled in this range.

==1415813==       Range "Constructing lsh tables"
            Type  Time(%)      Time     Calls       Avg       Min       Max  Name
          Range:  100.00%  6.0810ms         1  6.0810ms  6.0810ms  6.0810ms  Constructing lsh tables
No kernels were profiled in this range.
No API activities were profiled in this range.

==1415813==       Range "Finding potential matches"
            Type  Time(%)      Time     Calls       Avg       Min       Max  Name
          Range:  100.00%  831.96ms         1  831.96ms  831.96ms  831.96ms  Finding potential matches
No kernels were profiled in this range.
No API activities were profiled in this range.

==1415813==       Range "Matching potential matches"
            Type  Time(%)      Time     Calls       Avg       Min       Max  Name
          Range:  100.00%  2.44374s         1  2.44374s  2.44374s  2.44374s  Matching potential matches
 GPU activities:   88.64%  1.93133s         1  1.93133s  1.93133s  1.93133s  match_points_395_gpu(int, int, float*, float*, int, int*, int*, int*, float*, int*, float*)
                   11.36%  247.49ms       188  1.3165ms  5.2480us  1.3797ms  [CUDA memcpy HtoD]
                    0.00%  15.712us         4  3.9280us  3.7760us  4.3200us  [CUDA memcpy DtoH]
      API calls:   95.55%  2.2060ms       188  11.734us  4.2030us  42.139us  cuMemcpyHtoDAsync
                    2.75%  63.549us         4  15.887us  4.2480us  48.976us  cuMemcpyDtoHAsync
                    1.69%  39.117us         1  39.117us  39.117us  39.117us  cuLaunchKernel

